ra = m2
xa = sapply(strsplit(colnames(ra), split = "_"), "[[",2)
ya = sapply(strsplit(colnames(ra), split = "_"), "[[",3)
#plot(as.numeric(xa), as.numeric(ya), cex = 1, ylim=c(63, 1), xlim=c(1, 66), ylab = '', xlab = '', xaxt='n',   yaxt='n', bty = 'n', col = c("black"), pch = 16)
#dev.off()
# # he.image = readJPEG("HE_2.jpg")
# # test.y = attributes(he.image)$dim[1]
# # test.x = attributes(he.image)$dim[2]
#
#
# ### RA1
# # #HE_1
# test.y = 24791
# test.x = 23204
# #
# # #HE_2
# test.x = 23134
# test.y = 24880
# #
# # # HE_3
# # test.x = 23187
# # test.y = 24771
# #
# # # # HE_4
# test.x = 23148
# test.y = 24772
#
# # RA2
# # HE_1
# # test.x = 23208
# # test.y = 24942
# #
# # #HE_2
# test.x = 23075
# test.y = 24958
# #
# # # HE_3
# # test.x = 23184
# # test.y = 24636
# #
# # HE_4
# # test.x = 23204
# # test.y = 24635
#
# # HE_5
# test.x = 23088
# test.y = 24818
# #
# # #HE_6
# # test.x = 23158
# # test.y = 24675
# #
# # # HE_7
# # test.x = 22926
# # test.y = 24723
# #
# # # # HE_8
# # test.x = 23180
# # test.y = 24928
#
# # # # HE_9
# test.x = 23090
# test.y = 24855
#ra6_1
test.x = 9568
test.y = 10151
#ra6_2
test.x = 9616
test.y = 10142
xan = (as.numeric(xa)-4)*test.x/(66-3*2.5)
yan = (as.numeric(ya)-4)*test.y/(64-3*2.5)
jpeg("RA6_Mask_HE_2.jpg", width = test.x, height = test.y)
#plot.new()
#plot(c(1,test.x), c(test.y,1), ylab = '', xlab = '', xaxt='n', yaxt='n', bty = 'n', col = "white")
#rasterImage(he.image, 1, 1, test.x, test.y)
#par(new=T)
plot(xan, yan, cex = 25, ylim=c(test.y, 1), xlim=c(1, test.x), ylab = '', xlab = '', xaxt='n',   yaxt='n', bty = 'n', col = c("black"), pch = 16)
dev.off()
cbind(paste0(xa, "_", ya), xan, yan)
ss = cbind(paste0(xa, "_", ya), xan, yan)
row.names(ss) = ss[,1]
ss = ss[,-1]
colnames(ss) = c("pix_x", "pix_y")
ss
write.table(ss, file = "RA6_1_xy.tsv", sep = "\t", quote = F, col.names = T)
#ra = read.delim("Raw counts and images for paper/4 samples/Biopsy2_exp_matrix_2.txt", row.names = 1, header = T)
load("RA6_norm.exp.values.1")
ra = m1
xa = sapply(strsplit(colnames(ra), split = "_"), "[[",2)
ya = sapply(strsplit(colnames(ra), split = "_"), "[[",3)
#plot(as.numeric(xa), as.numeric(ya), cex = 1, ylim=c(63, 1), xlim=c(1, 66), ylab = '', xlab = '', xaxt='n',   yaxt='n', bty = 'n', col = c("black"), pch = 16)
#dev.off()
# # he.image = readJPEG("HE_2.jpg")
# # test.y = attributes(he.image)$dim[1]
# # test.x = attributes(he.image)$dim[2]
#
#
# ### RA1
# # #HE_1
# test.y = 24791
# test.x = 23204
# #
# # #HE_2
# test.x = 23134
# test.y = 24880
# #
# # # HE_3
# # test.x = 23187
# # test.y = 24771
# #
# # # # HE_4
# test.x = 23148
# test.y = 24772
#
# # RA2
# # HE_1
# # test.x = 23208
# # test.y = 24942
# #
# # #HE_2
# test.x = 23075
# test.y = 24958
# #
# # # HE_3
# # test.x = 23184
# # test.y = 24636
# #
# # HE_4
# # test.x = 23204
# # test.y = 24635
#
# # HE_5
# test.x = 23088
# test.y = 24818
# #
# # #HE_6
# # test.x = 23158
# # test.y = 24675
# #
# # # HE_7
# # test.x = 22926
# # test.y = 24723
# #
# # # # HE_8
# # test.x = 23180
# # test.y = 24928
#
# # # # HE_9
# test.x = 23090
# test.y = 24855
#ra6_1
test.x = 9568
test.y = 10151
# #ra6_2
# test.x = 9616
# test.y = 10142
#
# #ra6_3
# test.x = 9618
# test.y = 10159
#
# #ra6_4
# test.x = 9603
# test.y = 10174
xan = (as.numeric(xa)-4)*test.x/(66-3*2.5)
yan = (as.numeric(ya)-4)*test.y/(64-3*2.5)
jpeg("RA6_Mask_HE_1.jpg", width = test.x, height = test.y)
#plot.new()
#plot(c(1,test.x), c(test.y,1), ylab = '', xlab = '', xaxt='n', yaxt='n', bty = 'n', col = "white")
#rasterImage(he.image, 1, 1, test.x, test.y)
#par(new=T)
plot(xan, yan, cex = 25, ylim=c(test.y, 1), xlim=c(1, test.x), ylab = '', xlab = '', xaxt='n',   yaxt='n', bty = 'n', col = c("black"), pch = 16)
ss = cbind(paste0(xa, "_", ya), round(xan,3), round(yan,3))
row.names(ss) = ss[,1]
ss = ss[,-1]
colnames(ss) = c("pix_x", "pix_y")
write.table(ss, file = "RA6_1_xy.tsv", sep = "\t", quote = F, col.names = T)
dev.off()
# he.image = readJPEG("../Josh_celery/RA1_1_HE.jpg")
# plot(c(1,35), c(33,1), ylab = '', xlab = '', xaxt='n', yaxt='n', bty = 'n', col = "white")
# rasterImage(he.image, 1, 1, test.y, test.x)
# par(new=T)
# plot(xa, ya, cex = 1.1, ylim=c(35, 1), xlim=c(1, 33), ylab = '', xlab = '', xaxt='n',   yaxt='n', bty = 'n', col = c("black"), pch = 16)
#
load("RA6_norm.exp.values.2")
ra = m2
xa = sapply(strsplit(colnames(ra), split = "_"), "[[",2)
ya = sapply(strsplit(colnames(ra), split = "_"), "[[",3)
#plot(as.numeric(xa), as.numeric(ya), cex = 1, ylim=c(63, 1), xlim=c(1, 66), ylab = '', xlab = '', xaxt='n',   yaxt='n', bty = 'n', col = c("black"), pch = 16)
#dev.off()
# # he.image = readJPEG("HE_2.jpg")
# # test.y = attributes(he.image)$dim[1]
# # test.x = attributes(he.image)$dim[2]
#
#
# ### RA1
# # #HE_1
# test.y = 24791
# test.x = 23204
# #
# # #HE_2
# test.x = 23134
# test.y = 24880
# #
# # # HE_3
# # test.x = 23187
# # test.y = 24771
# #
# # # # HE_4
# test.x = 23148
# test.y = 24772
#
# # RA2
# # HE_1
# # test.x = 23208
# # test.y = 24942
# #
# # #HE_2
# test.x = 23075
# test.y = 24958
# #
# # # HE_3
# # test.x = 23184
# # test.y = 24636
# #
# # HE_4
# # test.x = 23204
# # test.y = 24635
#
# # HE_5
# test.x = 23088
# test.y = 24818
# #
# # #HE_6
# # test.x = 23158
# # test.y = 24675
# #
# # # HE_7
# # test.x = 22926
# # test.y = 24723
# #
# # # # HE_8
# # test.x = 23180
# # test.y = 24928
#
# # # # HE_9
# test.x = 23090
# test.y = 24855
#ra6_1
#test.x = 9568
#test.y = 10151
# #ra6_2
test.x = 9616
test.y = 10142
#
# #ra6_3
# test.x = 9618
# test.y = 10159
#
# #ra6_4
# test.x = 9603
# test.y = 10174
xan = (as.numeric(xa)-4)*test.x/(66-3*2.5)
yan = (as.numeric(ya)-4)*test.y/(64-3*2.5)
jpeg("RA6_Mask_HE_2.jpg", width = test.x, height = test.y)
#plot.new()
#plot(c(1,test.x), c(test.y,1), ylab = '', xlab = '', xaxt='n', yaxt='n', bty = 'n', col = "white")
#rasterImage(he.image, 1, 1, test.x, test.y)
#par(new=T)
plot(xan, yan, cex = 25, ylim=c(test.y, 1), xlim=c(1, test.x), ylab = '', xlab = '', xaxt='n',   yaxt='n', bty = 'n', col = c("black"), pch = 16)
ss = cbind(paste0(xa, "_", ya), round(xan,3), round(yan,3))
row.names(ss) = ss[,1]
ss = ss[,-1]
colnames(ss) = c("pix_x", "pix_y")
write.table(ss, file = "RA6_2_xy.tsv", sep = "\t", quote = F, col.names = T)
dev.off()
load("RA6_norm.exp.values.3")
ra = m3
xa = sapply(strsplit(colnames(ra), split = "_"), "[[",2)
ya = sapply(strsplit(colnames(ra), split = "_"), "[[",3)
#plot(as.numeric(xa), as.numeric(ya), cex = 1, ylim=c(63, 1), xlim=c(1, 66), ylab = '', xlab = '', xaxt='n',   yaxt='n', bty = 'n', col = c("black"), pch = 16)
#dev.off()
# # he.image = readJPEG("HE_2.jpg")
# # test.y = attributes(he.image)$dim[1]
# # test.x = attributes(he.image)$dim[2]
#
#
# ### RA1
# # #HE_1
# test.y = 24791
# test.x = 23204
# #
# # #HE_2
# test.x = 23134
# test.y = 24880
# #
# # # HE_3
# # test.x = 23187
# # test.y = 24771
# #
# # # # HE_4
# test.x = 23148
# test.y = 24772
#
# # RA2
# # HE_1
# # test.x = 23208
# # test.y = 24942
# #
# # #HE_2
# test.x = 23075
# test.y = 24958
# #
# # # HE_3
# # test.x = 23184
# # test.y = 24636
# #
# # HE_4
# # test.x = 23204
# # test.y = 24635
#
# # HE_5
# test.x = 23088
# test.y = 24818
# #
# # #HE_6
# # test.x = 23158
# # test.y = 24675
# #
# # # HE_7
# # test.x = 22926
# # test.y = 24723
# #
# # # # HE_8
# # test.x = 23180
# # test.y = 24928
#
# # # # HE_9
# test.x = 23090
# test.y = 24855
#ra6_1
#test.x = 9568
#test.y = 10151
# #ra6_2
#test.x = 9616
#test.y = 10142
#
# #ra6_3
test.x = 9618
test.y = 10159
#
# #ra6_4
# test.x = 9603
# test.y = 10174
xan = (as.numeric(xa)-4)*test.x/(66-3*2.5)
yan = (as.numeric(ya)-4)*test.y/(64-3*2.5)
jpeg("RA6_Mask_HE_3.jpg", width = test.x, height = test.y)
#plot.new()
#plot(c(1,test.x), c(test.y,1), ylab = '', xlab = '', xaxt='n', yaxt='n', bty = 'n', col = "white")
#rasterImage(he.image, 1, 1, test.x, test.y)
#par(new=T)
plot(xan, yan, cex = 25, ylim=c(test.y, 1), xlim=c(1, test.x), ylab = '', xlab = '', xaxt='n',   yaxt='n', bty = 'n', col = c("black"), pch = 16)
ss = cbind(paste0(xa, "_", ya), round(xan,3), round(yan,3))
row.names(ss) = ss[,1]
ss = ss[,-1]
colnames(ss) = c("pix_x", "pix_y")
write.table(ss, file = "RA6_3_xy.tsv", sep = "\t", quote = F, col.names = T)
dev.off()
load("RA6_norm.exp.values.4")
ra = m4
xa = sapply(strsplit(colnames(ra), split = "_"), "[[",2)
ya = sapply(strsplit(colnames(ra), split = "_"), "[[",3)
#plot(as.numeric(xa), as.numeric(ya), cex = 1, ylim=c(63, 1), xlim=c(1, 66), ylab = '', xlab = '', xaxt='n',   yaxt='n', bty = 'n', col = c("black"), pch = 16)
#dev.off()
# # he.image = readJPEG("HE_2.jpg")
# # test.y = attributes(he.image)$dim[1]
# # test.x = attributes(he.image)$dim[2]
#
#
# ### RA1
# # #HE_1
# test.y = 24791
# test.x = 23204
# #
# # #HE_2
# test.x = 23134
# test.y = 24880
# #
# # # HE_3
# # test.x = 23187
# # test.y = 24771
# #
# # # # HE_4
# test.x = 23148
# test.y = 24772
#
# # RA2
# # HE_1
# # test.x = 23208
# # test.y = 24942
# #
# # #HE_2
# test.x = 23075
# test.y = 24958
# #
# # # HE_3
# # test.x = 23184
# # test.y = 24636
# #
# # HE_4
# # test.x = 23204
# # test.y = 24635
#
# # HE_5
# test.x = 23088
# test.y = 24818
# #
# # #HE_6
# # test.x = 23158
# # test.y = 24675
# #
# # # HE_7
# # test.x = 22926
# # test.y = 24723
# #
# # # # HE_8
# # test.x = 23180
# # test.y = 24928
#
# # # # HE_9
# test.x = 23090
# test.y = 24855
#ra6_1
#test.x = 9568
#test.y = 10151
# #ra6_2
#test.x = 9616
#test.y = 10142
#
# #ra6_3
#test.x = 9618
#test.y = 10159
#
# #ra6_4
test.x = 9603
test.y = 10174
xan = (as.numeric(xa)-4)*test.x/(66-3*2.5)
yan = (as.numeric(ya)-4)*test.y/(64-3*2.5)
jpeg("RA6_Mask_HE_4.jpg", width = test.x, height = test.y)
#plot.new()
#plot(c(1,test.x), c(test.y,1), ylab = '', xlab = '', xaxt='n', yaxt='n', bty = 'n', col = "white")
#rasterImage(he.image, 1, 1, test.x, test.y)
#par(new=T)
plot(xan, yan, cex = 25, ylim=c(test.y, 1), xlim=c(1, test.x), ylab = '', xlab = '', xaxt='n',   yaxt='n', bty = 'n', col = c("black"), pch = 16)
ss = cbind(paste0(xa, "_", ya), round(xan,3), round(yan,3))
row.names(ss) = ss[,1]
ss = ss[,-1]
colnames(ss) = c("pix_x", "pix_y")
write.table(ss, file = "RA6_4_xy.tsv", sep = "\t", quote = F, col.names = T)
dev.off()
filenames = list.files(glob2rx("RA6*_selected_adjusted_spots_3D_manual_app"), pattern = ".csv")
filenames
glob2rx("RA6*_selected_adjusted_spots_3D_manual_app")
filenames = list.files("./", glob2rx("RA6*_selected_adjusted_spots_3D_manual_app"))
filenames
sort(filenames)
load(f)
filenames = list.files("./", glob2rx("RA6*_selected_adjusted_spots_3D_manual_app"))
for (f in sort(filenames)){
load(f)
nt = assign(get(f))
# nm = sapply(strsplit(f, split = "_"), "[[", 1)
# write.table(nt, file = paste("RA2_", ct, "_stdata_under_tissue_IDs.txt", sep =""), quote = F, sep ="\t")
# ct = ct + 1
}
# he.image = readJPEG("/Users/sanjavickovic/Desktop/morphoSPOT/Raw counts and images for paper/RA6/RA6_1_HE_small.jpg")
# plot(c(1,63), c(65,1), ylab = '', xlab = '', xaxt='n', yaxt='n', bty = 'n', col = "white")
# rasterImage(he.image, 1, 1, 63, 65)
# par(new=T)
# plot(xa, ya, cex = 1.1,ylim=c(63, 1), xlim=c(1, 66), ylab = '', xlab = '', xaxt='n',   yaxt='n', bty = 'n', col = c("black"), pch = 16)
# #dev.off()
ct = 1
filenames = list.files("./", glob2rx("RA6*_selected_adjusted_spots_3D_manual_app"))
filenames = list.files("./", glob2rx("RA6*_selected_adjusted_spots_3D_manual_app"))
for (f in sort(filenames)){
load(f)
nt = assign(get(paste0("s", ct)))
# nm = sapply(strsplit(f, split = "_"), "[[", 1)
# write.table(nt, file = paste("RA2_", ct, "_stdata_under_tissue_IDs.txt", sep =""), quote = F, sep ="\t")
# ct = ct + 1
}
paste0("s", ct)
nt = assign(get(unquote(paste0("s", ct))))
get(paste0("s", ct))
ct = 1
filenames = list.files("./", glob2rx("RA6*_selected_adjusted_spots_3D_manual_app"))
for (f in sort(filenames)){
load(f)
nt = get(paste0("s", ct))
# nm = sapply(strsplit(f, split = "_"), "[[", 1)
write.table(nt, file = paste("RA6_", ct, "_xyz.tsv", sep =""), quote = F, sep ="\t", col.names = T, row.names = T)
# ct = ct + 1
}
ct = 1
filenames = list.files("./", glob2rx("RA6*_selected_adjusted_spots_3D_manual_app"))
for (f in sort(filenames)){
load(f)
nt = get(paste0("s", ct))
# nm = sapply(strsplit(f, split = "_"), "[[", 1)
write.table(nt, file = paste("RA6_", ct, "_xyz.tsv", sep =""), quote = F, sep ="\t", col.names = T, row.names = T)
ct = ct + 1
}
